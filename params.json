{"name":"JOSS","tagline":"Java library for OpenStack Storage, aka Swift","body":"Java OpenStack Storage (JOSS) [![Build Status](https://travis-ci.org/java-openstack/joss.png)](https://travis-ci.org/java-openstack/joss)\r\n=============================\r\nJOSS is a Java client for the [OpenStack Storage component](http://docs.openstack.org/essex/openstack-object-storage/admin/content/ch_introduction-to-openstack-object-storage.html) REST interface. In order to use it you must have an account with an OpenStack Storage provider, such as the [CloudVPS Object Store](https://www.cloudvps.nl/blog/cloudvps-object-store-beta-test-join-and-get-free-storage/).\r\n\r\nIn order to use JOSS in your project, simply add the following dependency:\r\n\r\n```xml\r\n        <dependency>\r\n            <groupId>org.javaswift</groupId>\r\n            <artifactId>joss</artifactId>\r\n            <version>0.7.1</version>\r\n        </dependency>\r\n```\r\n\r\nYou can also download the artifact on [Maven Search](http://search.maven.org)\r\n\r\nGetting Started\r\n---------------\r\nYour Object Store provider will have provided you with the following information in order to authenticate yourself:\r\n* tenant\r\n* username\r\n* password\r\n* authentication URL\r\n\r\nWe start by opening up a stateful client and **authenticating** ourselves:\r\n\r\n```java\r\n    Account account = new ClientImpl().authenticate(tenant, username, password, url);\r\n```\r\n\r\nOn failure, the client will throw an exception. On success, the account can now be used to execute actions on the Object Store. The account takes care of adding the token to the calls, so you don't have to worry about that. You should be aware, however, that tokens expire after 24 hours. The client will get a new token when it encounters a 401 and retry the original command just once.\r\n\r\nNext, we want to create a public container, where we can store our images:\r\n\r\n```java\r\n    Container container = account.getContainer(\"images\");\r\n    container.create();\r\n    container.makePublic();\r\n```\r\n\r\nA container is private by default, so you will have to explicitly set it to public to be able to access it through its public URL.\r\n\r\nTo check whether the creation succeeded, list the containers.\r\n\r\n```java\r\n    Collection<Container> containers = account.list();\r\n    for (Container currentContainer : containers) {\r\n        System.out.println(currentContainer.getName());\r\n    }\r\n```\r\n\r\nNow it is time to upload a file to the Object Store. In this example, we take an image located in the root directory of the file system.\r\n\r\n```java\r\n    StoredObject object = container.getObject(\"dog.png\");\r\n    object.uploadObject(new File(\"/dog.png\"));\r\n    System.out.println(\"Public URL: \"+object.getPublicURL());\r\n```\r\n\r\nIf you fire up your browser, you can navigate to the public URL to see your resource for real. This is only possible because the container has been set to public. If it was private, you would not be able to do this.\r\n\r\nYou can also check whether the upload succeeded by listing the objects in a container or by fetching the object information.\r\n\r\n```java\r\n    System.out.println(\"Last modified:  \"+object.getLastModified());\r\n    System.out.println(\"ETag:           \"+object.getEtag());\r\n    System.out.println(\"Content type:   \"+object.getContentType());\r\n    System.out.println(\"Content length: \"+object.getContentLength());\r\n\r\n    Collection<StoredObject> objects = container.list();\r\n    for (StoredObject currentObject : objects) {\r\n        System.out.println(currentObject.getName());\r\n    }\r\n```\r\n\r\nAlternatively, besides [File](http://docs.oracle.com/javase/6/docs/api/java/io/File.html), you could also use a *byte[]* or an [InputStream](http://docs.oracle.com/javase/6/docs/api/java/io/InputStream.html) to upload a file.\r\n\r\nIt is time to download what you just uploaded. Here we go.\r\n\r\n```java\r\n    object.downloadObject(new File(\"/dog2.png\"));\r\n```\r\n\r\nOpen the file \"/dog2.png\" on the file system to verify that the operation worked. Again, also byte[] and InputStream are at your disposal. *On using InputStream be aware that you are responsible for closing the stream by calling close() on the wrapper*.\r\n\r\nNow, if you want the object to be retrievable through another URL, you will have to move the object. This is accomplished by executing first a copy, then a delete action.\r\n\r\n```java\r\n    StoredObject newObject = container.getObject(\"new-dog.png\");\r\n    object.copyObject(container, newObject);\r\n    object.delete();\r\n    System.out.println(\"Public URL: \"+object.getPublicURL()); // no longer retrievable\r\n    System.out.println(\"Public URL: \"+newObject.getPublicURL()); // the new URL\r\n```\r\n\r\nYou can once more use the browser to access both resources. You will see that the first URL gives you a 404, while the second one now gives you the original resource.\r\n\r\nIt is possible to add metadata to both containers and objects.\r\n\r\n```java\r\n    Map<String, Object> metadata = new TreeMap<String, Object>();\r\n    metadata.put(\"title\", \"Some Title\");\r\n    metadata.put(\"department\", \"Some Department\");\r\n    container.setMetadata(metadata);\r\n```\r\n\r\nLikewise, this information can be retrieved, as seen above.\r\n\r\n```java\r\n    Map<String, String> returnedMetadata = container.getMetadata();\r\n    for (String name : returnedMetadata.keySet()) {\r\n        System.out.println(\"META / \"+name+\": \"+returnedMetadata.get(name));\r\n    }\r\n```\r\n\r\nThere are many situations in which it is not necessary, not possible, or even plain clumsy, to be connected to external dependencies. For those situations, JOSS offers the InMemory implementation of the OpenStackClient.\r\n\r\n```java\r\n    ClientMock client = new ClientMock();\r\n```\r\n\r\nAll the operations work basically in the same way. It is possible to run the in-memory client and have it hold the resources for a local run of your application. *Note that there is no such thing as a public URL for the in-memory run*.\r\n\r\nNote that you will have to add some users to authenticate against.\r\n\r\n```java\r\n    MockUserStore users = new MockUserStore();\r\n    users.addUser(\"testuser\", \"testpassword\");\r\n    client.setUsers(users);\r\n```\r\n\r\nPresumably, you are using Spring or something similar, in which case it will be easy to configure your profiles to either use the real client or the mock client.\r\n\r\nThis wraps up the tutorial. Good luck using JOSS.\r\n\r\nBackground\r\n----------\r\nJOSS provides access to the Container part of the OpenStack API. It is a specialized utility for this purpose. You will be able to:\r\n* access your account\r\n* handle containers\r\n* handle objects, including upload and download\r\n\r\nGenerally, Java developers want to be able to isolate their applications from the target servers during development, which is why JOSS support an in-memory mode. Simply have your application instantiate OpenStackClientInMemory (instead of OpenStackClientImpl) and you have a fully fledged in-memory Storage container, useful for testing your application on your own development system and isolating your application during various test stages.\r\n\r\nDone and To-do\r\n--------------\r\nThings JOSS can do for you:\r\n* Java-based wrapper library for OpenStack, so REST calls do not have to be made directly\r\n* option to switch between real (ie, HTTPS target) and mock mode\r\n* in-memory storage of objects for unit testing and local application run purposes\r\n* auto-reconnecting your Swift session\r\n* documentation and tutorials to help you get started\r\n\r\nLicense\r\n-------\r\n   Licensed under the Apache License, Version 2.0 (the \"License\");\r\n   you may not use this file except in compliance with the License.\r\n   You may obtain a copy of the License at\r\n\r\n\thttp://www.apache.org/licenses/LICENSE-2.0\r\n\r\n   Unless required by applicable law or agreed to in writing, software\r\n   distributed under the License is distributed on an \"AS IS\" BASIS,\r\n   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n   See the License for the specific language governing permissions and\r\n   limitations under the License.\r\n\r\nMore information\r\n----------------\r\n\r\n_On JOSS_\r\n\r\n* High level explanation of JOSS; http://blog.42.nl/articles/accessing-openstack-object-storage-with-java-through-joss\r\n* Hands-on JOSS tutorial; http://blog.42.nl/articles/joss-tutorial-using-joss-to-access-openstack-storage\r\n* Architecture models; http://blog.42.nl/articles/joss-architecture-approaches-integrating-with-openstack-object-storage\r\n* If-Modified-Since; http://blog.42.nl/articles/instruct-java-facilitate-browser-cache-if-modified-since\r\n* Working JOSS tutorial project; https://github.com/java-openstack/tutorial-joss-quickstart\r\n* Working JOSS streaming project; https://github.com/java-openstack/tutorial-joss-streaming\r\n* Working JOSS If-Modified-Since project; https://github.com/java-openstack/tutorial-joss-if-modified-since\r\n\r\n_On Cloud VPS Object Store_\r\n\r\n* How to use the CloudVPS ObjectStore as a beta-tester; http://www.vankouteren.eu/blog/2012/08/cloudvps-object-store-beta-introduction/\r\n* How to get a beta-tester account on the CloudVPS ObjectStore; https://www.cloudvps.nl/blog/cloudvps-object-store-beta-test-join-and-get-free-storage/\r\n* CloudVPS writes on collaboration with 42 to create JOSS; https://www.cloudvps.com/blog/cloudvps-object-store-beta-tester-contributes-java-library/\r\n\r\n_On the OpenStack API_\r\n\r\n* OpenStack API; http://api.openstack.org/\r\n* OpenStack API; http://docs.openstack.org/api/openstack-object-storage/1.0/content/\r\n\r\nAlso, check out the [WIKI](https://github.com/java-openstack/joss/wiki)\r\n\r\nKeep up to date on the library development by joining the Java OpenStack Storage discussion group [Google Group](https://groups.google.com/forum/?fromgroups#!forum/java-openstack-storage---joss)\r\n\r\nor follow us on [Twitter](http://twitter.com/JavaOSS)\r\n\r\nSpecial thanks to Oscar Westra van Holthe - Kind and Erik Hooijmeijer for premium advice and support.\r\n\r\nSponsor\r\n-------\r\nThis component was graciously donated by [42 BV](http://www.42.nl) ![42 logo](http://www.42.nl/images/42-54x59.png \"42\")","google":"UA-39343905-1","note":"Don't delete this file! It's used internally to help with page regeneration."}